/**
 * thenjs: v0.11.1
 * https://github.com/teambition/then.js
 */
"use strict";!function(){function a(a){return null==a}function b(a){return"function"==typeof a}function c(a,b,c){return c=c||"function",new Error("Argument "+(a&&a.toString())+' in "'+b+'" is not a '+c+"!")}function d(b,d,e,f){function g(c,d,e){return a(d)?(k[c]=arguments.length>3?o.call(arguments,2):e,i-=1,0>i&&b(null,k)):b(d)}var h,i,j,k=[];if(!q(d))return b(c(d,"each","array"));if(i=h=d.length-1,0>i)return b(null,k);for(var l=0;h>=l;l++)j=g.bind(null,l),j._self=!0,e.call(f,j,d[l],l,d)}function e(b,d,e,f){function g(c,k){if(!a(c))return b(c);if(j[i]=arguments.length>2?o.call(arguments,1):k,i+=1,i>h)return b(null,j);try{e.call(f,g,d[i],i,d)}catch(l){b(l)}}var h,i=0,j=[];return q(d)?(h=d.length-1,0>h?b(null,j):(g._self=!0,void e.call(f,g,d[i],i,d))):b(c(d,"eachSeries","array"))}function f(b,d,e){function f(c,d,e){return a(d)?(k[c]=arguments.length>3?o.call(arguments,2):e,h-=1,0>h&&b(null,k)):b(d)}var g,h,i,j,k=[];if(!q(d))return b(c(d,"parallel","array"));if(h=g=d.length-1,0>h)return b(null,k);for(var l=0;g>=l;l++)j=d[l],i=f.bind(null,l),i._self=!0,j.call(e,i,l,d)}function g(b,d,e){function f(c,k){if(!a(c))return b(c);if(j[i]=arguments.length>2?o.call(arguments,1):k,i+=1,i>g)return b(null,j);h=d[i];try{h.call(e,f,i,d)}catch(l){b(l)}}var g,h,i=0,j=[];return q(d)?(g=d.length-1,0>g?b(null,j):(h=d[i],f._self=!0,h.call(e,f,i,d))):b(c(d,"series","array"))}function h(a,b){p(function(){try{b()}catch(c){a(c)}})}function i(a,c){return b(c)?c._self?c:c.bind(null,a):null}function j(){}function k(c){function h(){}function k(a,b){var c=new h,d=c._defer.bind(c);return d._self=c,a(d,b),b&&b._result&&b._defer.apply(b,b._result),c}var l=h.prototype=new j,m=[],p=0;return l.constructor=h,(!c||b(c))&&(l.debug=c),l.all=function(a){return k(function(b,c){c._all=i(b,a)},this)},l.then=function(a,b){return k(function(c,d){d._success=i(c,a),d._error=i(c,b)},this)},l.fail=function(a){return k(function(b,c){c._fail=i(b,a),c._success=b.bind(null,null),c._success._self=b._self,c._fail&&m.push(c._fail)},this)},l.each=function(a,b,c){return k(function(e,f){f._each=function(f,g,h){d(e,a||f,b||g,c||h)}},this)},l.eachSeries=function(a,b,c){return k(function(d,f){f._eachSeries=function(f,g,h){e(d,a||f,b||g,c||h)}},this)},l.parallel=function(a,b){return k(function(c,d){d._parallel=function(d,e){f(c,a||d,b||e)}},this)},l.series=function(a,b){return k(function(c,d){d._series=function(d,e){g(c,a||d,b||e)}},this)},l._defer=function(c){function d(){if(f)return f.apply(f._self,j);if(!a(c))throw c;h?h.apply(h._self,o.call(j,1)):i._result=j}function e(a){a.stack=a.stack||a.description,g||m.length?(g=g||m.shift(),g.call(g._self,a)):b(n.onerror)?n.onerror(a):i._result=j}var f,g,h,i=this,j=arguments;if(i._result!==!1){i._result?i._result=!1:i.debug&&(p+=1,i.debug.apply(i.debug,["\nResult of chain "+p+": "].concat(o.call(j)))),f=i._all,g=i._fail?m.shift():i._error,h=i._success||i._each||i._eachSeries||i._parallel||i._series;try{d()}catch(k){e(k)}}},k}function l(a){return function(b,c,d,e){return k(e)(function(e){h(e,a.bind(null,e,b,c,d))})}}function m(a){return function(b,c,d){return k(d)(function(d){h(d,a.bind(null,d,b,c))})}}function n(a,c,d){return k(d)(function(d){h(d,b(a)?a.bind(c,d):d)})}var o=[].slice,p="object"==typeof process&&process.nextTick?process.nextTick:setTimeout,q=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};Function.prototype.bind||(Function.prototype.bind=function(a){var b=this,c=o.call(arguments,1);return function(){return b.apply(a,c.concat(o.call(arguments)))}}),j.prototype.debug="object"==typeof console&&function(){console.log.apply(console,arguments)},n.constructor=j,n.each=l(d),n.eachSeries=l(e),n.parallel=m(f),n.series=m(g),"object"==typeof module&&"object"==typeof module.exports?module.exports=n:"function"==typeof define&&define.amd?define([],function(){return n}):"object"==typeof window&&(window.then=n)}();